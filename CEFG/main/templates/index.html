{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="wrap">
  <div class="paper">
    <h1 class="section-title">NLP Graph (placeholder NER)</h1>
    <p class="lead">Paste a sentence below. The site will (with a placeholder) detect entity spans and draw a graph of entities and relationships.</p>

    <div class="controls">
      <textarea id="sentence" placeholder="Type or paste a sentence here">Barack Obama visited Microsoft in 2014 and later spoke at the University of Oxford.</textarea>
      <div class="controls-column">
        <button id="analyze" class="analyze-button">Analyze</button>
        <button id="random" class="btn-secondary">Random sentence</button>
      </div>
    </div>
    <div class="meta">This demo uses randomly-generated spans (placeholder for a real NER model). Entities are connected to the sentence and to each other if they overlap or are adjacent.</div>

    <div class="graph-area">
      <svg id="svg"></svg>
      <div class="legend">
        <span class="chip">Sentence</span>
        <span class="chip">Entity</span>
      </div>
    </div>

    <section class="top-margin_twenty">
      <h2 class="section-title">Saved graphs</h2>
      <p class="lead">Click any graph to view details or hover to preview.</p>
      <ul id="graphs-list" class="no-padding-no-margin">
        {% for g in graphs %}
          <li class="graph-item node" data-id="{{ g.id }}">
            <strong>#{{ g.id }}</strong> â€” {{ g.text|truncatechars:80 }}
          </li>
        {% empty %}
          <li class="empty-state">No saved graphs yet. Analyze a sentence to create one!</li>
        {% endfor %}
      </ul>
    </section>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{% static 'js/nlpgraph.js' %}" defer></script>
<script src="{% static 'js/graphs_list.js' %}" defer></script>
<script src="{% static 'js/nlpGraphListeners.js' %}" defer></script>
{% endblock %}
